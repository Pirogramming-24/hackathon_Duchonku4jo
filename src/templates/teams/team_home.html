{% extends "base.html" %}

{% block extra_head %}
<style>
    :root {
        --green: #0BEC12;
        --beige: #FCF9EA;
        --header-gray: #D9D9D9;
        --line: #2b2b2b;
    }

    .wrap {
        max-width: 1200px;
        margin: 0 auto;
        padding: 34px 24px 60px;
        position: relative;
    }

    /* ìƒë‹¨ ì•¡ì…˜ ì˜ì—­ */
    .actions {
        display: flex;
        align-items: center;
        justify-content: center;
        position: relative;
        margin-top: 12px;
        margin-bottom: 22px;
    }

    .btn {
        display: inline-flex;
        align-items: center;
        justify-content: center;
        border: 0;
        cursor: pointer;
        border-radius: 999px;
        font-weight: 800;
    }

    .btn-green {
        background: var(--green);
        color: #000;
    }

    .btn-score {
        padding: 12px 26px;
        font-size: 22px;
        letter-spacing: .2px;
    }

    /* ìƒˆë¡œê³ ì¹¨ ë™ê·¸ë¼ë¯¸ ë²„íŠ¼(ìš°ì¸¡) */
    .refresh {
        position: absolute;
        right: 6px;
        top: 50%;
        transform: translateY(-50%);
        width: 44px;
        height: 44px;
        border-radius: 50%;
        background: var(--green);
        display: flex;
        align-items: center;
        justify-content: center;
    }

    .refresh svg {
        width: 22px;
        height: 22px;
        stroke: #000;
    }

    /* ë©”ì¸ í‘œ ì»¨í…Œì´ë„ˆ */
    .board {
        width: min(1020px, 100%);
        margin: 0 auto;
        background: #FCF9EA;
        border-radius: 16px;
        overflow: hidden;
        box-shadow: 0 10px 28px rgba(0, 0, 0, .35);
    }

    .grid {
        display: grid;
        grid-template-columns: repeat(var(--team-count), 1fr);
    }

    .col {
        min-height: 340px;
        border-left: 1px solid rgba(0, 0, 0, .25);
    }

    .col:first-child {
        border-left: 0;
    }

    .col-top {
        height: 58px;
        background: #D9D9D9;
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 32px;
        font-weight: 900;
        color: #111;
        border-bottom: 1px solid rgba(0, 0, 0, .25);
    }

    .col-body {
        height: 280px;
    }


    /* í•˜ë‹¨ íŒ€ ì €ì¥ ë²„íŠ¼ */
    .save-wrap {
        width: min(1020px, 100%);
        margin: 18px auto 0;
        display: flex;
        justify-content: flex-end;
    }

    .btn-save {
        padding: 10px 22px;
        font-size: 18px;
    }

    .col-body.filled {
        padding: 18px 12px 10px;
        display: flex;
        flex-direction: column;
        align-items: center;
        gap: 10px;
    }

    .pill {
        width: 78%;
        height: 32px;
        border-radius: 999px;
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 18px;
        font-weight: 900;
        color: #111;
    }

    .pill.male {
        background: #B1DDFF;
    }

    .pill.female {
        background: #FFD7EB;
    }

    .pill.nonmajor {
        text-decoration: underline;
        text-underline-offset: 3px;
        text-decoration-thickness: 3px;
    }

    .avg {
        margin-top: 16px;
        width: 92%;
        font-size: 13px;
        font-weight: 800;
        color: #111;
        text-align: left;
    }

    /* =========================
   ğŸ“± Mobile (â‰¤ 480px)
   ========================= */
    @media (max-width: 480px) {
        .wrap {
            padding: 18px 14px 46px;
        }

        /* ìƒë‹¨ ë²„íŠ¼ ì˜ì—­: ì„¸ë¡œ ì •ë ¬ + í„°ì¹˜ ì˜ì—­ í‚¤ìš°ê¸° */
        .actions {
            margin: 8px 0 14px;
            gap: 10px;
        }

        .btn-score {
            width: 100%;
            max-width: 360px;
            height: 44px;
            font-size: 16px;
            padding: 0;
        }

        /* ìƒˆë¡œê³ ì¹¨ ë²„íŠ¼: ìš°ì¸¡ ê³ ì • ëŒ€ì‹  ê°™ì€ ì¤„/ìœ„ì¹˜ ì•ˆì •í™” */
        .refresh {
            right: 0;
            width: 44px;
            height: 44px;
        }

        /* ë³´ë“œ: í™”ë©´ ê½‰ ì°¨ê²Œ + ë¼ìš´ë“œ ì¡°ê¸ˆ ì¤„ì„ */
        .board {
            width: 100%;
            border-radius: 14px;
        }

        /* âœ… í•µì‹¬: gridë¥¼ ê°€ë¡œ ìŠ¤í¬ë¡¤ ê°€ëŠ¥í•œ ìŠ¬ë¼ì´ë”ë¡œ */
        .grid {
            display: grid;
            grid-auto-flow: column;
            /* ì»¬ëŸ¼ì„ ê°€ë¡œë¡œ íë¥´ê²Œ */
            grid-auto-columns: 86%;
            /* í•œ ë²ˆì— íŒ€ 1ê°œê°€ ê±°ì˜ ë‹¤ ë³´ì´ê²Œ */
            grid-template-columns: unset;
            /* ê¸°ì¡´ repeat í•´ì œ */
            overflow-x: auto;
            /* ê°€ë¡œ ìŠ¤í¬ë¡¤ */
            scroll-snap-type: x mandatory;
            /* ìŠ¤ëƒ… */
            -webkit-overflow-scrolling: touch;
        }

        /* ìŠ¤í¬ë¡¤ë°” ìˆ¨ê¹€(ì„ íƒ) */
        .grid::-webkit-scrollbar {
            height: 0;
        }

        .col {
            min-height: 320px;
            border-left: 0;
            border-right: 1px solid rgba(0, 0, 0, .18);
            scroll-snap-align: start;
            /* ìŠ¤ëƒ… ìœ„ì¹˜ */
            background: var(--beige);
        }

        .col-top {
            height: 52px;
            font-size: 24px;
        }

        .col-body {
            height: auto;
            /* ê³ ì • ë†’ì´ í•´ì œ */
            min-height: 240px;
        }

        .col-body.filled {
            padding: 14px 12px 12px;
            gap: 8px;
        }

        .pill {
            width: 92%;
            height: 34px;
            font-size: 16px;
        }

        .avg {
            margin-top: 10px;
            width: 92%;
            font-size: 12px;
        }

        /* í•˜ë‹¨ ì €ì¥ ë²„íŠ¼: ì¤‘ì•™ + í’€í­ */
        .save-wrap {
            width: 100%;
            margin-top: 14px;
            justify-content: center;
        }

        .btn-save {
            width: 100%;
            max-width: 360px;
            height: 44px;
            font-size: 16px;
            padding: 0;
        }
    }

    /* ì•„ì£¼ ì‘ì€ í°(â‰¤ 360px)ì—ì„œëŠ” í•œ í™”ë©´ì— ê±°ì˜ 1ê°œì”© */
    @media (max-width: 360px) {
        .grid {
            grid-auto-columns: 92%;
        }
    }
</style>
{% endblock %}

{% block content %}
<div class="wrap">
    <div class="actions">
        <a class="btn btn-green btn-score" href="{% url 'teams:score_input' week.id %}">
            ë©¤ë²„ ê³¼ì œ ì ìˆ˜ ì…ë ¥
        </a>

        <!-- ìƒˆë¡œê³ ì¹¨: previewë¡œ ì´ë™(= ë‹¤ì‹œ ë½‘ê¸°) -->
        <a class="refresh" href="{% url 'teams:team_preview' week.id %}" aria-label="ìƒˆë¡œê³ ì¹¨">
            <svg viewBox="0 0 24 24" fill="none">
                <path d="M20 6v6h-6" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" />
                <path d="M4 18v-6h6" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" />
                <path d="M20 12a8 8 0 0 0-14.9-4M4 12a8 8 0 0 0 14.9 4" stroke-width="2" stroke-linecap="round"
                    stroke-linejoin="round" />
            </svg>
        </a>
    </div>

    <div class="board">
        <div class="grid" style="--team-count: {{ week.team_count|default:5 }};">
            {% if teams and teams|length > 0 %}
            {% for team in teams %}
            <div class="col">
                <div class="col-top">{{ team.team_no }}ì¡°</div>

                <div class="col-body filled">
                    {% for m in team.members %}
                    <div class="pill
                        {% if m.gender == 'M' %}male{% else %}female{% endif %}
                        {% if m.major == 'X' %}nonmajor{% endif %}">
                        {{ m.name }}
                    </div>
                    {% endfor %}

                    <div class="avg">
                        ê³¼ì œ í‰ê·  ì ìˆ˜: {{ team.team_score|floatformat:0 }}ì 
                    </div>
                </div>
            </div>
            {% endfor %}
            {% else %}
            {% for _ in ""|center:week.team_count %}
            <div class="col">
                <div class="col-top">{{ forloop.counter }}ì¡°</div>
                <div class="col-body"></div>
            </div>
            {% endfor %}
            {% endif %}
        </div>
    </div>


    <div class="save-wrap">
        <!-- ì´ˆê¸° í™”ë©´ì—ì„œë„ ë²„íŠ¼ì€ ë³´ì´ê²Œ(ì›í•˜ë©´ disabled ì²˜ë¦¬ ê°€ëŠ¥) -->
        <a class="btn btn-green btn-save" href="{% url 'teams:team_save' week.id %}">
            íŒ€ ì €ì¥
        </a>
    </div>
</div>
{% endblock %}